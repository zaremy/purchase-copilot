# Pre-Purchase Copilot: Product Requirements Document

## 1. Product Summary & Positioning

Pre-Purchase Copilot is a workflow-driven iOS application designed to empower consumers in the used car buying process. It transforms the often chaotic and emotional task of purchasing a used vehicle into a structured, repeatable, and data-driven workflow. The app serves as a pre-purchase checklist, inspection tracker, candidate comparison tool, and negotiation assistant. Its core differentiator is a specialized LLM "Copilot" that serves two functions: first, it acts as a **vehicle-specific expert**, generating contextual checklist items based on the car's make, model, and year by drawing on a knowledge base of common issues, recalls, and TSBs. Second, it acts as a **structured-data analyst**, reasoning exclusively over the user's inspection findings to identify risks, compare vehicles, and generate negotiation points. By enforcing a strict, field-only data model, the app provides decision-quality insights without the reliability concerns of unstructured data interpretation, positioning itself as a trusted, objective companion for avoiding bad purchases.

## 2. Problem Statement & User Pains

The used car market is fraught with information asymmetry, leaving buyers vulnerable to costly mistakes. The process is typically unstructured, stressful, and lacks a clear methodology, leading to significant financial and emotional risk. Buyers struggle to remember all the necessary checks, objectively compare different vehicles, and effectively negotiate based on a car's actual condition. This results in a lack of confidence and a high probability of overpaying or, worse, purchasing a vehicle with hidden mechanical or legal issues.

### Top 10 User Pains (Ranked)

1.  **Fear of Buying a "Lemon"**: The single greatest fear is purchasing a car with hidden, expensive problems (e.g., engine, transmission, frame damage).
2.  **Forgetting What to Check**: During an inspection, it's easy to forget crucial items, from checking for rust to verifying fluid levels.
3.  **Difficulty Comparing Cars Objectively**: Buyers struggle to compare multiple vehicles with different features, mileages, prices, and conditions in a consistent way.
4.  **Ineffective Negotiation**: Many buyers lack the confidence, data, or strategy to negotiate effectively, often leaving thousands of dollars on the table.
5.  **Risk of Scams and Title Issues**: Private-party sales carry the risk of title fraud, undisclosed liens, or other scams that can have serious legal and financial consequences.
6.  **Information Overload**: Juggling information from listings, photos, seller conversations, and inspection notes is overwhelming.
7.  **Emotional Decision-Making**: The excitement of a potential new car can lead to impulsive decisions and overlooking red flags.
8.  **Not Knowing What Questions to Ask**: Buyers are often unsure what to ask the seller about the vehicle's history, maintenance, or condition.
9.  **Wasting Time on Bad Cars**: Buyers spend significant time and effort visiting and inspecting vehicles that they should have disqualified earlier.
10. **Misinterpreting a Pre-Purchase Inspection (PPI)**: Even when a buyer gets a PPI, they may not fully understand the technical report or how to use its findings in a negotiation.

## 3. Target Users/Personas

We will focus on four primary personas, each with distinct needs and Jobs-to-be-Done (JTBD).

| Persona | Description | Job-to-be-Done (JTBD) |
|---|---|---|
| **The First-Time Buyer** | Young (18-25), on a tight budget, and highly risk-averse. They have little to no experience buying a car and are anxious about making a costly mistake. | "Help me avoid getting ripped off and guide me through the process so I don't miss anything important." |
| **The Family Upgrader** | A growing family (30-45) needing a larger, reliable vehicle (e.g., SUV, minivan). They are time-poor and value safety and reliability above all else. | "Help me efficiently find the safest, most reliable vehicle for my family's budget and ensure it has no hidden problems." |
| **The Cautious Enthusiast** | A hobbyist or commuter looking for a specific type of vehicle (e.g., a sports car, a specific truck). They are knowledgeable but want a systematic way to vet candidates and document everything. | "Help me meticulously inspect and compare multiple examples of the car I want, so I can find the best one and negotiate a fair price based on its true condition." |
| **The Private-Party Pro** | An experienced buyer who prefers the value of the private-party market but is wary of the associated risks (scams, title issues). | "Give me a tool to quickly identify and disqualify risky private-party sellers and to build a strong, evidence-based case for my negotiation." |

Our initial acquisition wedge will be **The First-Time Buyer** and **The Cautious Enthusiast**. First-time buyers have the most acute pain and are actively seeking guidance, making them receptive to a workflow-driven app. Enthusiasts appreciate a systematic approach and are likely to become power users and advocates.

## 4. Key User Journeys

These user journeys illustrate the end-to-end workflows for our key personas.

### Journey 1: Single-Car Purchase Flow (Private Party)

**Actor**: The First-Time Buyer

1.  **Discover & Capture**: Finds a car on a marketplace and enters the VIN and asking price into Pre-Purchase Copilot.
2.  **Decode & Question**: The app decodes the VIN, populates the vehicle's specs, and the Copilot generates a list of initial questions to ask the seller based on missing information.
3.  **Inspect**: At the vehicle, the user follows the app's comprehensive checklist, marking each item as Pass, Fail, or Unknown, and adding notes and photos.
4.  **Identify Issues**: For each failed item, the app automatically creates an "Issue" (e.g., "Brakes squeal loudly").
5.  **Consult Copilot**: The user asks, "What are my top risks?" The Copilot analyzes the structured checklist data and responds, citing the specific fields: "The brakes were marked as 'Fail' and you noted a 'loud squeal'. This is a critical safety issue that must be inspected by a mechanic."
6.  **Manage PPI**: The app recommends a Pre-Purchase Inspection (PPI) due to the identified risks. The user schedules a PPI and later transcribes the mechanic's findings into dedicated structured fields within the app.
7.  **Negotiate**: The Copilot's Negotiation Builder uses the logged issues (including the PPI findings) to generate a tiered offer strategy and a negotiation script.
8.  **Export**: Once the purchase is complete, the user exports a "Vehicle Dossier" PDF containing all their notes, photos, and findings for their records.

### Journey 2: Multi-Car Comparison Flow

**Actor**: The Cautious Enthusiast

1.  **Capture Multiple**: The user adds three similar vehicles (e.g., three different Mazda Miatas) as candidates in the app.
2.  **Inspect in Parallel**: The user inspects each vehicle using the same checklist, achieving a high completion percentage for each.
3.  **Compare View**: The user opens the "Compare" tab, which displays a side-by-side matrix of the candidates, showing key differences in price, mileage, risk score, and the number of identified issues.
4.  **LLM Comparison**: The user asks the Copilot, "Which of these three is the best deal?" The Copilot returns a structured comparison, highlighting trade-offs: "Candidate A has the lowest mileage, but Candidate B has a lower risk score and no reported rust. Candidate C is the cheapest but has the most unknowns in the checklist."
5.  **Eliminate & Deep Dive**: Based on the comparison, the user archives one candidate and decides to get a PPI for the remaining two.
6.  **Final Decision**: After entering the PPI findings for the top two candidates, the user asks the Copilot for a final recommendation, which is provided with a stated confidence level based purely on the completed fields.

### Journey 3: Private-Party "Scam/Doc Risk" Flow

**Actor**: The Private-Party Pro

1.  **Capture & Flag**: The user enters the VIN from a private-party listing. The app decodes the VIN and finds a mismatch (e.g., the listing says it's a 2018, but the VIN decodes to a 2016).
2.  **Alert & Question**: The app immediately displays a prominent warning about the VIN discrepancy. The Copilot generates critical questions: "Why is there a year discrepancy? Can you confirm the name on the title matches your ID? Is the title branded (e.g., Salvage, Rebuilt)?"
3.  **Paperwork Check**: The user meets the seller and uses the dedicated "Paperwork" section of the checklist. They mark `title_seen` as 'No' and `seller_name_matches_id` as 'No'.
4.  **Risk Assessment**: The user asks the Copilot, "Should I walk away?" The Copilot, citing the specific fields, responds: "High risk is indicated. The `vin_year` does not match the `listing_year`, and `title_seen` is 'No'. It is not recommended to proceed without verifying the official title document."
5.  **Decision**: Confident in the data, the user walks away from the potential scam and archives the candidate.

## 5. MVP Scope (Must Ship)

The MVP is focused on delivering the core workflow for a single user inspecting one or more cars. The goal is to solve the most critical user pains: forgetting what to check, difficulty comparing, and lacking negotiation confidence.

### Must-Have Features:

*   **Candidate Management**: Ability to add, edit, and archive vehicle candidates using a VIN.
*   **Free VIN Decoding**: Automatic fetching of basic vehicle data from the NHTSA API.
*   **Hybrid Inspection Checklist**: A dynamic checklist composed of a comprehensive base checklist (~60-70 items) and a set of **LLM-generated contextual items** specific to the vehicle's make, model, and year.
*   **Structured Field Inputs**: All checklist items must use structured inputs (Pass/Fail/Unknown, severity sliders, numeric inputs, picklists).
*   **Photo Attachments**: Ability to attach photos to individual checklist items.
*   **Issue Tracking**: Automatic creation of "Issues" from failed checklist items.
*   **Risk & Completeness Scoring**: The v1 scoring model must be implemented to provide at-a-glance feedback.
*   **Side-by-Side Comparison**: A simple, horizontally scrollable matrix to compare key fields of 2+ candidates.
*   **Field-Only LLM Copilot**: The Copilot must be able to perform its core functions (summarize, compare, generate questions) based *only* on the structured data snapshot.
*   **Negotiation Builder**: The v1 tool that converts logged issues into a tiered offer strategy and a basic, editable script.
*   **Vehicle Dossier Export**: Ability to generate and share a PDF summary of a single candidate.

### Acceptance Criteria for MVP:

*   A user can successfully add a car, complete the entire inspection checklist, and receive a risk score.
*   A user can compare at least two cars and see the key differences in a table.
*   A user can ask the Copilot for a summary of a car and receive a response that is verifiably based on the fields they entered.
*   A user can generate a negotiation script based on at least one logged issue.
*   The app must function reliably in an offline state for checklist completion and photo attachment, syncing when connectivity is restored.

## 6. Non-Goals (Explicitly Excluded from MVP)

To ensure a focused and achievable MVP, the following features and capabilities will be explicitly excluded:

*   **No User Accounts / Cloud Sync (Initially)**: All data will be stored locally on the user's device in the MVP to simplify development. Cloud sync will be a V1.1 feature.
*   **No Unstructured Data Ingestion**: The LLM will not process images, PDFs, or freeform text inputs beyond short note fields.
*   **No Direct Integration with Listing Sites**: Users must manually enter the VIN and other initial data.
*   **No Paid History Report Integration**: Users will be directed to purchase reports on their own and can manually transcribe the findings.
*   **No Mechanic Marketplace or Scheduling**: The app will only provide a template for contacting a mechanic; it will not have a directory or booking system.
*   **No Customizable Checklists**: The checklist will be built-in and not editable by the user in the MVP.
*   **No Team or Collaboration Features**: The app is designed for a single user.
*   **No Android Version**: The initial launch will be on iOS only.

## 7. Feature Spec (MVP + V1)

This section provides a detailed breakdown of the core features, data models, and logic that will power the Pre-Purchase Copilot.

### Core Objects / Data Model

The application's data is structured around a set of core objects designed for clarity, integrity, and direct consumption by the LLM. This model ensures that all reasoning is based on verifiable, user-provided data points.

| Object | Description | Fields (MVP) |
|---|---|---|
| **Listing** | Represents a car for sale from an external source. | `listing_id` (PK), `source_url`, `source_name` (e.g., Craigslist), `date_captured` |
| **Vehicle** | Contains the static, decoded attributes of a specific vehicle, identified by its VIN. | `vin` (PK), `year`, `make`, `model`, `trim`, `engine_type`, `transmission_type`, `exterior_color`, `interior_color`, `nhtsa_data_json` |
| **Candidate** | The user's primary working object for a car they are considering. It links a `Listing` and a `Vehicle` and tracks all user-generated data. | `candidate_id` (PK), `listing_id` (FK), `vin` (FK), `nickname`, `status` (active, archived, purchased), `asking_price`, `target_price`, `repair_budget`, `taxes_fees_estimate`, `completion_percent`, `risk_score` |
| **InspectionItem** | A single, discrete item within the pre-purchase checklist. | `item_id` (PK), `candidate_id` (FK), `section` (e.g., exterior, interior), `item_name`, `response_type` (pass_fail, severity, numeric), `required` (boolean) |
| **FieldResponse** | The user's actual input for an `InspectionItem`. This creates a log of all data points collected. | `response_id` (PK), `item_id` (FK), `candidate_id` (FK), `value_pass_fail` (pass/fail/unknown), `value_severity` (1-10), `value_numeric` (number), `value_text` (notes), `photo_attachment_path`, `timestamp` |
| **Issue** | A specific problem or concern identified during the inspection, automatically generated from a failed `InspectionItem` or manually created. | `issue_id` (PK), `candidate_id` (FK), `source_item_id` (FK), `description`, `severity` (1-10), `estimated_cost_min`, `estimated_cost_max`, `status` (open, resolved), `is_negotiation_point` (boolean) |
| **DealTerm** | A component of a negotiation offer, derived from an `Issue`. | `term_id` (PK), `candidate_id` (FK), `issue_id` (FK), `term_type` (price_reduction, repair_request), `value`, `justification_text` |
| **Offer** | A complete offer package to be presented to the seller. | `offer_id` (PK), `candidate_id` (FK), `offer_price`, `offer_terms_json`, `script_text`, `date_created` |
| **ComparisonScore** | A calculated score to facilitate side-by-side comparison of multiple candidates. | `comparison_id` (PK), `candidate_ids` (array of FKs), `scores_json` (contains risk, value, completeness scores for each), `llm_summary_text` |
| **Conversation** | A record of an interaction with the LLM Copilot. | `conversation_id` (PK), `candidate_ids` (array of FKs), `request_type` (summary, comparison, negotiation), `input_fields_json_snapshot`, `llm_response_json`, `timestamp` |

### Hybrid Checklist Taxonomy

The checklist is a hybrid model. It starts with a **base checklist** of ~70 universal items. Crucially, after VIN decoding, the **LLM generates additional, contextual checklist items** based on known issues for that specific vehicle (e.g., 'Check for VANOS rattle on this BMW model'). The user can approve or reject these suggestions, creating a tailored inspection plan for every car.

*   **Exterior Body & Paint**
*   **Tires & Wheels**
*   **Glass, Lights & Wipers**
*   **Interior & Electronics**
*   **Under the Hood (Engine Off)**
*   **Test Drive**
*   **Paperwork & Vitals**

### Scoring Model v1

The model provides a **Risk Score** (0-100, lower is better) and a **Completeness Score** (0-100%).

*   **Risk Score Calculation**: The score starts at 0. Failed items add points based on severity and category weight (e.g., Paperwork issues have a 5x weight). A penalty is added for critical items left "Unknown." Major flags, like a salvage title, add a large, fixed number of points.
*   **Completeness Score Calculation**: `(answered_fields + unknown_fields) / total_fields * 100`

### Negotiation Builder

This feature converts logged issues into a negotiation strategy.

1.  **Select Issues**: User selects which problems to include.
2.  **Estimate Costs**: User inputs repair cost estimates for each issue.
3.  **Calculate Offer Tiers**: The app subtracts the estimated costs from the asking price to create Aggressive, Fair, and Conservative offer tiers.
4.  **Generate Script**: The LLM generates a polite, editable script that justifies the offer based on the selected issues.

### Exportable "Vehicle Dossier"

A shareable PDF summary containing:

*   Vehicle info, VIN, and asking price.
*   A summary of all inspection findings (issues, passed items, unknowns).
*   Paperwork status.
*   PPI findings (if entered).
*   User-attached photos.

Crucially, the dossier contains **only** user-entered field data, not LLM-generated text.

## 8. LLM “Chatbot” Spec (FIELD-ONLY)

The Copilot is the app's core intelligence, but it is strictly a **structured-data analyst**. It does not interpret images, PDFs, or any unstructured data. Its sole purpose is to transform the user's structured field inputs into decision-quality outputs.

### LLM Capabilities (User-Facing)

*   **Summarize Vehicle Risks**: Answers "What are my top risks?" by analyzing failed checklist items and their severity.
*   **Compare Candidates**: Compares multiple vehicles on a like-for-like basis using the completed checklist data.
*   **Generate Contextual Checklist**: Proposes vehicle-specific inspection items based on the car's make, model, and year.
*   **Generate Seller Questions**: Creates a list of questions to ask the seller based on fields marked "Unknown" or where data is missing.
*   **Build Negotiation Pack**: Helps the user prepare for negotiation by turning logged issues into a script and offer strategy.

### LLM Input/Output Contract

*   **Input**: For every request, the app sends a secure JSON snapshot of all relevant fields and their values for the candidate(s) in question. This is the LLM's entire world.
*   **Output**: The LLM's response must conform to a strict JSON schema, which the app then renders into a user-friendly chat bubble. Key schemas include:
    *   **Summary**: `{ facts_from_fields[], inferences[], unknowns_and_questions[] }`
    *   **Comparison**: `{ comparison_table[], top_risks[], recommendation_with_confidence }`
    *   **NegotiationPack**: `{ issue_list[], price_adjustments[], offer_range[], script[] }`

### Critical Guardrails

1.  **Cite-Your-Fields**: Every statement the LLM makes *must* be traceable to the specific field(s) it is based on. The app will make these source fields tappable in the UI.
2.  **No Definitive Claims**: The LLM will use calibrated language (e.g., "The fields indicate high risk...") and will not make definitive legal or financial statements (e.g., "This car is a scam").
3.  **Unknowns Lead to Questions**: If a critical field is missing, the LLM's primary job is to ask the user to provide that information.
4.  **Safety First**: The LLM is prohibited from providing any mechanical or repair instructions. It will always defer to a qualified mechanic.

## 9. VIN + History Strategy

Our strategy for vehicle data is two-pronged, prioritizing free, reliable data for the MVP while providing a clear path for integrating paid, premium data.

### Free VIN Decode Integration (MVP)

*   **Service**: We will use the free, public NHTSA vPIC API for all basic VIN decoding.
*   **Implementation**: When a user enters a VIN, our backend server makes a call to the NHTSA API. The response is used to populate the core `Vehicle` object fields (Year, Make, Model, Trim, etc.). We will cache these results in our database to reduce redundant API calls.
*   **User Experience**: This happens automatically in the background. If the VIN is invalid, the user is prompted to correct it. If the service is unavailable, the user can enter the vehicle's core attributes manually.

### Paid History Report Integration (V1 and beyond)

We will not have direct integration with paid history report providers (like CarFax) in the MVP. The LLM is strictly forbidden from reading these reports directly.

*   **MVP Approach**: The app will include a dedicated "History Report" section in the checklist with structured fields (e.g., `accidents_reported`, `salvage_title_reported`). Users who purchase a report independently can transcribe the key findings into these fields. They can also attach the report PDF to the candidate for their own records, but it will be inaccessible to the Copilot.
*   **V1.1 Vision**: We will explore a partnership with a history report provider to allow users to purchase reports directly within the app. Our backend would receive the report data as structured JSON, which would automatically populate the relevant fields, providing a seamless user experience while maintaining the "field-only" constraint for the LLM.

## 10. UX/IA

The user experience is designed around a clear, linear workflow that guides the user from capturing a vehicle to making a final decision. The information architecture prioritizes quick access to the user's active list of cars and the Copilot assistant.

### Primary Navigation & Screen List

The app uses a standard bottom tab bar with four primary destinations:

1.  **Candidates**: The main list of cars the user is tracking.
2.  **Compare**: The side-by-side comparison matrix.
3.  **Copilot**: The LLM chat interface.
4.  **Library**: Archived candidates and saved dossiers.

The screen hierarchy flows logically from the list to the detail view, with modals used for atomic tasks like adding a new candidate or inputting a checklist item response.

### Critical Screen Wireframe Descriptions (Text)

*   **Candidates List (Home Screen)**: A clean, scannable list of vehicle cards. Each card displays the vehicle's photo, name, price, and two key status indicators: a **Checklist Completion** progress bar and a color-coded **Risk Score** badge. An empty state guides new users to add their first car.

*   **Candidate Detail**: This is the main workspace, featuring a top hero section with photos and key vehicle data. Below this are two prominent, non-scrolling **Score Cards** for Risk and Completeness. The majority of the screen is a tabbed view for **Checklist**, **Issues**, **PPI**, and **Negotiation**, allowing the user to dive into the details without losing context.

*   **Item Detail (Input Screen)**: A focused modal screen for responding to a single checklist item. The input control (e.g., Pass/Fail buttons, severity slider) is large and clear. Optional fields for notes and photos are placed below the primary input.

*   **Copilot (Chat Interface)**: A standard chat UI. A key feature is the **context selector** at the top, which makes it clear which vehicle(s) the user is currently discussing. Copilot responses are rendered in structured bubbles that differentiate between facts, inferences, and questions. All facts and inferences are tappable, allowing the user to see the exact source field(s) for that statement.

### UX for Contextual Checklist Items

*   **Presentation**: After the VIN is decoded, the app will present the LLM-generated checklist items in a clear, non-intrusive way (e.g., a modal screen or a dedicated section at the top of the checklist).
*   **User Control**: Each suggested item will be displayed with its justification (e.g., "Known issue for this model"). The user will have the ability to accept or dismiss each suggestion individually or all at once.
*   **Visual Distinction**: Accepted contextual items will be clearly marked within the main checklist (e.g., with a special icon or label) to differentiate them from the base items.

### Field Design

*   **States**: Every field can be Empty, Answered, or explicitly marked **Unknown**. This is critical for the scoring model and for generating relevant questions.
*   **Types**: Fields are strongly typed (e.g., Binary, Severity Slider, Numeric, Picklist) to ensure structured data capture.
*   **Gating**: The app enforces logical progression. For example, a user cannot generate a negotiation pack until at least one issue has been logged, and they cannot export a dossier until the checklist is reasonably complete (e.g., 60%+).

## 11. Monetization Options & Pricing Hypothesis

Our monetization strategy is designed to align with the user's journey and deliver value at the point of highest intent. We will adopt a **per-vehicle purchase model** for the MVP, which we believe is the most fair and transparent approach for our target users.

### Monetization Model: Per-Vehicle Purchase ("Pay-per-Dossier")

*   **Decision**: For the MVP, we will not use a subscription model. Instead, we will offer the core checklist and inspection features for free for a limited number of vehicles and then charge a one-time fee to unlock the advanced features for each additional vehicle.
*   **Rationale**:
    *   **Aligns with User Value**: The user's goal is to buy *one* car, not to be a perpetual car shopper. A subscription creates a commitment that doesn't match their episodic need.
    *   **Lowers Barrier to Entry**: Users can download the app and try the core inspection workflow on their first one or two cars for free. This allows them to experience the value proposition without any upfront financial commitment.
    *   **Clear Value Exchange**: The payment is tied to a specific, high-value outcome: thoroughly vetting a serious candidate. Users are more willing to pay when they are deep in the purchase funnel and need the advanced tools (comparison, negotiation, export) to make a final decision.

### Pricing Hypothesis (MVP)

*   **Free Tier**:
    *   Up to **2** active vehicle candidates.
    *   Full access to the inspection checklist and photo attachments.
    *   Basic risk and completeness scoring.
*   **Premium (Per-Vehicle)**:
    *   **Price**: **$14.99** one-time purchase per vehicle.
    *   **Unlocks**:
        *   Unlimited active vehicle candidates.
        *   Advanced Copilot features: multi-car comparison and negotiation pack generation.
        *   Vehicle Dossier PDF export.
        *   Ability to enter structured PPI findings.
*   **What's Free vs. Paid**:
The free tier is designed to be a fully functional tool for inspecting a single car. The paid tier unlocks the features necessary for **comparison shopping** and **deal-making**, which are the highest-value actions in the user journey.

### Unit Economics Outline (Rough)

*   **Customer Acquisition Cost (CAC)**: Initially high, driven by App Store search ads and content marketing. We will target keywords like "used car inspection checklist" and "how to negotiate car price."
*   **Lifetime Value (LTV)**: For the per-vehicle model, the LTV is initially low. However, a user who successfully buys a car using the app is likely to become a strong advocate, leading to organic growth. The average user might purchase premium access for 1-2 vehicles during their buying cycle.
*   **Key Assumption**: We are betting that the value of avoiding a multi-thousand-dollar mistake is worth a $14.99 fee. Our marketing and in-app messaging will focus on this ROI.

## 12. Analytics Plan

Our analytics plan is focused on measuring user engagement with the core workflow and identifying where users are successfully deriving value. We need to understand how many users are completing inspections, using the Copilot, and ultimately making decisions.

### North Star Metric

*   **Weekly Active Dossiers**: The number of unique vehicle candidates that have at least 70% of the checklist completed in a given week. This metric represents a user who is seriously engaged in vetting a car and is our best proxy for a user on the path to a purchase.

### Leading Indicators

*   **Checklist Completion Rate**: The average percentage of the checklist completed across all active candidates. This tells us if users are finding the checklist valuable and easy to use.
*   **Copilot Queries per Session**: The number of times a user interacts with the LLM Copilot. This measures engagement with our core differentiator.
*   **Issues Logged per Candidate**: The average number of issues logged for each car. This indicates that users are successfully identifying and recording potential problems.
*   **Conversion Rate to Paid**: The percentage of new users who purchase a premium vehicle slot within their first 30 days.

### Event Taxonomy & Funnels (MVP)

We will track the following key events to build our core funnels:

**Events:**

1.  `app_installed`
2.  `candidate_created`
3.  `vin_decoded_successfully`
4.  `checklist_section_completed` (with `section` property)
5.  `checklist_item_responded` (with `item_id` and `response` properties)
6.  `issue_logged` (auto or manual)
7.  `photo_attached`
8.  `copilot_query_sent` (with `query_type` property)
9.  `comparison_viewed`
10. `negotiation_pack_generated`
11. `dossier_exported`
12. `premium_purchase_initiated`
13. `premium_purchase_completed`

**Core Funnels:**

1.  **Activation Funnel**: `app_installed` → `candidate_created` → `checklist_item_responded` (at least 10 items) → `copilot_query_sent`
2.  **Monetization Funnel**: `candidate_created` (3rd vehicle) → `premium_purchase_initiated` → `premium_purchase_completed`
3.  **Decision Funnel**: `checklist_section_completed` (all sections) → `negotiation_pack_generated` → `dossier_exported`

## 13. Trust, Safety, and Compliance

Building and maintaining user trust is paramount. Our policies and features are designed to protect users, provide clear guidance, and comply with all relevant regulations.

### Scam Avoidance Guidance

*   **In-App Education**: The app will include a static, non-LLM-generated "Safety Tips" section in the Library. This will provide clear, actionable advice on how to spot common scams, such as title washing, curbstoning, and seller impersonation.
*   **Proactive Flags**: The app will automatically flag high-risk situations based on field data, such as a VIN/listing mismatch or a seller who is unwilling to show the title. These flags will trigger a prominent warning in the UI.
*   **Non-Legal Advice**: All guidance will be framed as educational and informational. The app will explicitly state that it is not providing legal advice and that users should consult with legal professionals for any title or contract disputes.

### Privacy, Data Retention, and Deletion

*   **Privacy by Design**: We will collect the minimum amount of personally identifiable information (PII) necessary. For the MVP (local storage), no user account is needed. When cloud sync is introduced, we will use a secure authentication provider.
*   **Data Sensitivity**: We recognize that VINs, photos, and notes can be sensitive. All data will be encrypted at rest and in transit. The VIN is linked to a vehicle, not a person, but we will treat it as sensitive data.
*   **Data Retention & Deletion**: Users will have the right to delete their data. In the MVP, this is as simple as deleting the app. In the cloud-sync version, users will have a "Delete Account" button that permanently erases all their data from our servers. Archived candidates will be retained unless explicitly deleted by the user.

### App Store Policy Considerations

*   **In-App Purchases**: Our monetization model (one-time purchase to unlock features for a vehicle) is a standard IAP that complies with Apple's App Store Review Guidelines. We will use Apple's native IAP framework.
*   **Data Privacy Disclosures**: We will provide a clear and accurate privacy policy and fill out the App Store Connect privacy "nutrition label" completely and honestly.
*   **LLM Usage**: We will be transparent with Apple during the review process about our use of an LLM. We will emphasize our strict guardrails, the field-only nature of the analysis, and the fact that the LLM does not have access to any unstructured or private user data beyond the specific fields being analyzed.

## 14. MVP Delivery Plan

Our delivery plan is organized by milestones, which are defined by scope, not by dates. This ensures we build the right features in the right order.

### Milestones

1.  **Milestone 1: The Inspector (Core Checklist)**
    *   **Scope**: Implement the ability to add a candidate via VIN, decode it with the NHTSA API, and complete the entire inspection checklist with all field types. All data is stored locally. No LLM, no scoring, no comparison.
    *   **Goal**: Prove the core data capture workflow is intuitive and robust.

2.  **Milestone 2: The Analyst (Scoring & Local Intelligence)**
    *   **Scope**: Build the v1 Risk and Completeness scoring models. Implement the automatic creation of `Issue` objects from failed checklist items. The scores should update in real-time.
    *   **Goal**: Provide the user with immediate, actionable feedback on their inspection.

3.  **Milestone 3: The Copilot (LLM Integration)**
    *   **Scope**: Integrate the OpenAI API via our secure backend. Build the mechanism to create the field-only JSON snapshot. Implement the Copilot chat interface and the first capability: summarizing risks for a single vehicle.
    *   **Goal**: Validate the core LLM workflow and the "Cite-Your-Fields" guardrail.

4.  **Milestone 4: The Shopper (Comparison & Negotiation)**
    *   **Scope**: Build the multi-candidate comparison matrix. Implement the Copilot's comparison and negotiation pack generation capabilities. Build the Dossier export feature.
    *   **Goal**: Deliver the features that support the user's final decision-making and deal-making process.

5.  **Milestone 5: The Business (Monetization & Polish)**
    *   **Scope**: Implement the In-App Purchase flow to unlock premium features. Finalize the UI/UX, add the analytics hooks, and conduct end-to-end testing.
    *   **Goal**: Prepare the app for submission to the iOS App Store.

### Backlog (Now / Next / Later)

*   **Now (MVP)**: Everything listed in the milestones above.
*   **Next (V1.1)**: User accounts and cloud sync, direct integration with a paid history report provider, customizable checklist sections.
*   **Later (V2.0)**: Android version, mechanic marketplace integration, VIN scanning from the camera (via OCR), and vehicle identification from a photo (via LMOCR).

## 15. Risks + Mitigations (Top 10)

| Risk | Likelihood | Impact | Mitigation Strategy |
|---|---|---|---|
| **1. LLM Reliability** | High | High | **Strictly field-only analysis**. The LLM never sees unstructured data. We will use rigorous prompt engineering, JSON output enforcement, and the "Cite-Your-Fields" guardrail to ensure outputs are traceable and grounded. Manual fallback is always available. |
| **2. User Trust** | Medium | High | Transparency is key. We will be explicit about the LLM's limitations. The UI will clearly separate facts from inferences. The "Cite-Your-Fields" feature is our primary tool for building trust. |
| **3. Scoring Credibility** | Medium | Medium | The v1 scoring model is intentionally simple and transparent. The app will allow users to see exactly how their score was calculated. We will avoid creating a "black box." |
| **4. Paid Data Dependencies** | Low (MVP) | Medium | The MVP relies only on the free NHTSA API. For V1, we will build the paid history report feature as a modular component, so if a provider changes their API, it doesn't break the core app. |
| **5. Legal Exposure** | Low | High | We will provide no legal, financial, or repair advice. The app is an informational tool. We will have a clear disclaimer and Terms of Service. The LLM is explicitly forbidden from making definitive claims about scams, legality, or safety. |
| **6. Edge Cases** | Medium | Medium | The checklist will include fields for common edge cases like salvage/rebuilt titles, but we cannot cover every possibility. The "Unknown" state and manual issue creation are the primary mitigations. |
| **7. User Adoption** | High | High | The free tier is designed to lower the barrier to entry. We will focus on content marketing and App Store Optimization to reach users actively searching for solutions to the pains we address. |
| **8. Inaccurate User Input** | High | Medium | The app is only as good as the data the user provides. We will use clear UI, helper text, and the "Unknown" option to encourage accurate inputs. The Copilot will also flag inconsistencies it finds in the data. |
| **9. App Store Rejection** | Low | Medium | We will be proactive in explaining our use of the LLM to Apple and will adhere strictly to their guidelines on IAP and data privacy. |
| **10. Competitor Risk** | Medium | Medium | Our defensible differentiator is the workflow-integrated, field-only LLM. While others may use LLMs, our strict focus on structured data provides a unique reliability advantage that generic chatbots cannot match. |
